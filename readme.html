<!doctype html>
<!-- This file is a slideshow that describes codeDocify. Use this as a starting point for your own slideshows. We are using slideshow code from "Rob Flaherty":https://github.com/robflaherty/html-slideshow/ with extensions by "dmfrancisco":https://github.com/dmfrancisco/slideshow.html . -->

<!-- h2. Header --> 

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  
  <!-- The below loads a shim for IE9 -->
  <!--[if lt IE 9]>
   <script src="https://cdcvs.fnal.gov/codeDocify/codedocify/js/html-slideshow/html5shim.js"></script>
   <![endif]-->  
  
  <!-- h3. Styles -->
  
  <!-- Load fonts from Google. See "Google Web Fonts":http://www.google.com/webfonts#HomePlace:home for more information -->
  <link href='http://fonts.googleapis.com/css?family=Droid+Sans|Calligraffitti|Droid+Sans+Mono|Maven+Pro|Crimson+Text' 
    rel='stylesheet' type='text/css'>
    
    <!-- Load in the main &l=css/html-slideshow.css|html-slideshow& stylesheet -->  
    <link href="https://cdcvs.fnal.gov/codeDocify/codedocify/css/html-slideshow.css" rel="stylesheet" type="text/css">
      
      <!-- The local stylesheet specific to this slideshow -->
      <style type="text/css">  
        body{ background:#fffff3; }
        #deck section {
          font-size: 25px;
          font-family: 'Droid Sans', Geneva, 'Lucida Sans', 'Lucida Grande', 'Lucida Sans Unicode', Verdana, sans-serif;
          text-shadow: 0px 1px 0px rgba(255, 255, 255, 0.8);
        }
        #deck h1 {
          font-size: 50px;
          font-family: 'Maven Pro', Geneva, 'Lucida Sans', 'Lucida Grande', 'Lucida Sans Unicode', Verdana, cursive;
          margin-bottom: 20px;
          border-bottom: 2px dashed;
        }
        #deck h2 { font-size: 30px; padding-bottom: 20px; }
        #deck p, #deck li {
          margin: 10px 0 10px 0;
        }
        ul {
          margin-left: 30px;
          
          li {
            list-style-type: square;
          }
        }
        .note {
          color: #adaea7;
          font-family: 'Calligraffitti', cursive;
        }
        .serif {
          font-family: 'Crimson Text', 'Baskerville', 'Palatino Linotype', 'Book Antiqua', Palatino, serif;
        }
        .important {
          background: #d6d5cf;
          padding: 0 10px 0 10px;
          font-size: 40px;
        }
        .gap {
          height: 15px;
        }
        .dotted {
          border-bottom: 1px dashed;
        }
        pre {
          font-family: "Droid Sans Mono", Mono;
          font-size: 20px;
        }
        mark, code, pre, .important {
          border: 1px solid #C6C9CB;
          .box-shadow(1px 1px 1px #d8d8d8);
        }
        mark {
          background: #f0f0ef;
          padding: 0 5px 0 5px;
        }
        </style>  
      
      <title>gm2artexamples</title>
</head>

<!-- h2. Body -->
<body>
  
  <!-- h3. Header bar -->
  <header>
    <h1>gm2artexamples</h1>
    <nav>
      <ul>
        <!-- Note that the buttons are defined in &l=css/html-slideshow.css& -->
        <li><button id="prev-btn" title="Previous slide">Previous Slide</button></li>
        <li><span id="slide-number"></span>/<span id="slide-total"></span></li>
        <li><button id="next-btn" title="Next Slide">Next Slide</button></li>
      </ul>
    </nav>
  </header>
  
  <!-- h3. Slide deck -->
  <div id="deck">
    
    <!-- Begin slides. Each @&lt;section&gt;@ is a slide -->
    <section>
      
      <h1>gm2artexamples</h1>
      <h2>Adam Lyon, Fermilab Scientific Computing Division<br />February 2012<br />Revision: &rev&</h2>
        <!--;Fix stupid xcode syntax coloring-->
        
      <p style="padding-top:50px; font-size:40px; text-align:center;"><mark>An example Art package</mark></p>
    </section>
    
    <section>
      <hgroup>
        <h1>What is a framework?</h1>
      </hgroup>
      <ul style="padding-top:20px">
        <li>Handles i/o for reading and writing data.</li>
        <li>Provides hooks to run your algorithms on every event, run, sub-run, ...</li>
        <li>Your algorithms and code live in pluggable modules. The framework loads them. </li>
        <li>The framework has facilities for configuration (itself and your code).</li>
        <li>Services are provided that your code can use (e.g. Random numbers, histogramming, ...). </li>
        <li>You write your code in small bits that fit into a big system.</li>
      </ul>
    </section>
    
    <section>
      <hgroup>
        <h1>What can your code do?</h1>
      </hgroup>
      
      <p>In simple terms,</p>
      <ul>
        <li>Run on every event and produce data to put into the event</li>
        <li>Run on every event and look at data, make histograms, ntuoles, ..</li>
        <li>Run a filter on every event (if event passes, continue processing)</li>
        <li>Run on every run or subrun and load calibrations, constants, look at data</li>
      </ul>
      <div class="gap"></div>
      <p>Art, like all frameworks, can do much more than the above. It is quite flexible and we will explore its capabilities.</p>
    </section>
    
    <section>
      <hgroup>
        <h1>Where are the Art docs?</h1>
      </hgroup>
      
      <p>There is no comprehensive manual for Art, unfortunately. Instead, documentation is scattered about many experiments. Here is a list of what to look for (aside from here).</p>
      
      <p>The main tutorial from the developers is at <a href="http://oink.fnal.gov/new_tut/tutorial.html">oink.fnal.gov</a>. It is meant to be given as a talk and not read alone, but it has useful definitions and some code.</p>
      
      <p>NOvA has some nice documentation on Redmine that should be viewable to you.</p>
      
      <ul>
        <li><a href="https://cdcvs.fnal.gov/redmine/projects/novaart/wiki/Using_the_Framework">Using the Framework</a> is best. Note that <i>FMWK</i> was their old framework system that Art replaced.</li>
          
        <li><a href="https://cdcvs.fnal.gov/redmine/projects/novaart/wiki/Running_Jobs">Running Jobs</a> has nice information on FHICL (the configuration language that Art uses).</li>
      </ul>
      
      <p>Mu2e has some very extensive documentation <a href="http://mu2e.fnal.gov/public/hep/computing/gettingstarted.shtml">here</a>. Scroll down to the heading "Mu2e maintained documentation about art and its tool chain"</p>
      
      <p>Some other links on Redmine are <a href="https://cdcvs.fnal.gov/redmine/projects/art">Art source and development</a>, <a href="https://cdcvs.fnal.gov/redmine/projects/cetlib">CET Library</a>, <a href="https://cdcvs.fnal.gov/redmine/projects/messagefacility">Message Facility</a> and <a href="https://cdcvs.fnal.gov/redmine/projects/fhicl-cpp">FHICL Configuration Language</a>.</p>
    </section>
  
    <section>
      <hgroup>
        <h1>How does g-2 fit into Art</h1>
      </hgroup>
      <p>Art is designed for event processing. For collider detectors, an event corresponds to a beam crossing. For g-2, the closest thing to an event is a beam spill -- that is the bunch of protons that hit the target, creating pions, then muons that enter the g-2 ring. Those muons eventually make positrons that are detected in the calorimeters and other detectors. All of the signals corresponding to one spill would make up an Art event.</p>
      
      <p>A run would be the group of events (or spills) that occurred during a particular configuration of the ring and detectors. For example, a run would correspond to a particular set of calibration constants or geometry.</p>
      
      <p>I'm not sure what we would do with sub-run. Typically, most experiments break up runs based on time (e.g. one hour of running) to make bookkeeping easier.</p>
    </section>
    
    <section>
      <hgroup>
        <h1>Learning Art with examples</h1>
      </hgroup>
      <p>The best way to learn Art is with examples. There is a Redmine project called <a href="https://cdcvs.fnal.gov/projects/gm2artexamples">gm2artexamples</a> with such code. The remainder of these slides will be explanations of this code and how you can write our own Art modules.</p>
      
      <p>If you need to, review the instructions at <a href="https://cdcvs.fnal.gov/redmine/projects/g-2/wiki/DevelopingCode">DevelopingCode</a> for how to set up your environment, checking out code, and building it.</p>
      
      <p>Set up a development area and then retrive code with</p>
      <pre>gm2d getRedmineGit gm2artexamples</pre><div class="gap"></div>
      
      and be sure to run the appropriate <code>setup_for_development</code> script. That is, 
      <pre># from within the build directory
        source ../src/gm2artexamples/ups/setup_for_development</pre><div class="gap"></div>
      
      <p>Now you can build the regular way. When done, try out Art with</p>
      <pre>gm2 -c hello.fcl</pre>
        
    </section>

    <section>
      <hgroup>
        <h1>A quick tour of <code>gm2artexamples</code></h1>
      </hgroup>
      
      <table>
        <tr>
         <td valign="center" style="font-size:70%;">
          <p>Here is the top level directory of <code>gm2artexamples</code>:
      
          <iframe style="width:500px; height:400px;" src="rmineRepository.html?proj=gm2artexamples&rev=&rev&&iframe">iframe goes here</iframe>
        </td>
        <td style="font-size:70%;" width="40%">
          <p>We will go over each sub-directory in subsequent slides. Here is an overview:</p>
          <ul>
            <li>Top level <code>CMakeLists.txt</code> file tells the build system how to build the package</li>
            <li><code>DataObjects</code> directory holds examples of very simple data objects</li>
            <li><code>HitAndTrackObjects</code> directory holds more realistic example data objects</li>
            <li><code>Lesson1</code> directory holds simple Art modules</li>
            <li><code>Lesson2</code> directory holds more complicated and realistic Art modules</li>
            <li><code>fcl</code> Art configration files
              </ul>
          
          <p>Note that each sub-directory has its own <code>CMakeLists.txt</code> file. 
        </td>

        </tr></table>

    </section>
    
    <section>
      <hgroup>
        <h1>Top level <code>CMakeLists.txt</code> file</h1>
      </hgroup>
      
      <iframe width="100%" height="80%" src="?path=CMakeLists.txt&&same&"></iframe>
            
    </section>
    
    <section>
      <hgroup>
        <h1><code>DataObjects</code> directory</h1>
      </hgroup>
      
      <p>The <code>DataObjects</code> directory holds the sources for data items we'll place into the event (used by Lesson1 modules). It is convenient to keep such code separate from the ART modules. The main data item we're making is defined in the <code>MyLittleDadum.hh</code> and <code>MyLittleDatum.cc</code> files. In this simple example, we're just storing one float value. But clearly you can store whatever you want. Some other files are also necessary so that Art can understand details of the data.</p>
      
      <p>Click <a href="rmineRepository.html?path=DataObjects&&same&">here</a> to see a directory listing. Click on the <code>DataObjects/CMakeLists.txt</code> file and follow its links. When done, return to this slide by using your browser's back button.</p>
    </section>
    
    <!-- End slides -->
  </div>
  
  <!-- h3. Boilerplate for the slideshow code -->
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script src="https://cdcvs.fnal.gov/codeDocify/codedocify/js/html-slideshow/jquery.jswipe-0.1.2.js"></script>  
  <script src="https://cdcvs.fnal.gov/codeDocify/codedocify/js/html-slideshow/htmlSlides.js"></script>
  <script>
    // Do our business when the DOM is ready for us
    $(function() {
      
      //You can trigger Javascript based on the slide number like this:
      $('html').bind('newSlide', function(e, id) { 
                     switch(id) {
                     case 2:
                     console.log('This is the second slide.');;
                     break;
                     case 3:
                     console.log('Hello, third slide.');
                     break;
                     }
                     });
      
      //One little option: hideToolbar (boolean; default = false)
      htmlSlides.init({ hideToolbar: true });
      
      });
    </script>
</body>
</html>
